set nocompatible
set autoindent
set ignorecase
set incsearch
set relativenumber
set smartcase
"set clipboard=unnamed

" Undo and backups {{{
" This enables backups and undo and creates an undo point after 
" the end of every sentence.
set undofile
set undodir=~/.cache/vim/
set backupdir=~/.cache/vim/
set directory=~/.cache/vim/

inoremap . .<C-g>u
inoremap ! !<C-g>u
inoremap ? ?<C-g>u
inoremap : :<C-g>u
"}}}

" Vundle Config {{{
filetype off
set rtp+=~/.vim/bundle/vundle/ 
call vundle#rc()

if has("python")
	Bundle 'SirVer/ultisnips'
endif

Bundle 'gmarik/vundle'
Bundle 'Lokaltog/powerline'
Bundle 'altercation/vim-colors-solarized'
Bundle 'nanotech/jellybeans.vim'
Bundle 'godlygeek/tabular'
Bundle 'klen/python-mode'
Bundle 'maksimr/vim-translator'
Bundle 'scrooloose/nerdtree'
Bundle 'tpope/vim-speeddating'
Bundle 'tpope/vim-fugitive'
Bundle 'tpope/vim-surround'
Bundle 'utl.vim'
Bundle 'vim-pandoc/vim-pandoc'
Bundle 'ervandew/supertab'

set rtp+=~/.vim/bundle/powerline/powerline/bindings/vim/ 

filetype plugin indent on
" }}}

" Look and Feel {{{
set showcmd
set cursorline
set cursorcolumn
set laststatus=2

set background=dark
let g:solarized_termtrans = 1
colorscheme solarized

set guifont="Inconsolata-dz for Powerline Medium 10"
set guioptions=""

if has("gui_running")
	set title
	let &titlestring = "gvim %f"
endif

if has("syntax")
	syntax on
endif
"}}}

" Window mappings {{{
map <C-j> <C-W>j
map <C-k> <C-W>k
map <C-h> <C-W>h
map <C-l> <C-W>l
"}}}

" Leader mappings {{{
map <leader>t :NERDTree<CR>
"}}}

" Toggle between relative, absolute, and no line numbers {{{
function! NumberToggle()
if(&relativenumber == 1)
	set number
elseif(&number == 1)
	set nonumber
else
	set relativenumber
endif
endfunc

nnoremap <C-n> :call NumberToggle()<cr>
"}}}

" UltiSnips Config {{{
let g:UltiSnipsSnippetDirectories=["UltiSnips","snippets"]
"}}}

"Add "a" to formatoptions and remove it automatically {{{
function! Prose()
	augroup PROSE
		autocmd InsertEnter * set formatoptions+=a
		autocmd InsertLeave * set formatoptions-=a
	augroup END
endfunc
" }}}

" File-type functions {{{
function! MailInit()
	set tw=72 ft=mail
	exe "normal O"
	exe "normal O"
	call Prose()
	set spell
	start
endfunc

function! MarkdownInit()
	set tw=72 ts=4 sts=4 et
	let g:pandoc_use_hard_wraps = 1
	let g:pandoc_auto_format = 1
	set spell
	syn off		" Pandoc slows down Vim a lot.
endfun
" }}}

" Auto-commands {{{
au BufNewFile,BufRead /tmp/mutt* :call MailInit() 
au BufNewFile,BufRead *.markdown,*.md :call MarkdownInit()
au FileType python setlocal tabstop=8 expandtab shiftwidth=4 softtabstop=4 tw=79 spell
" }}}

" vim: fdm=marker
