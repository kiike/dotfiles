PS1='${|
	\typeset e=$?

	REPLY+=${USER}@${HOSTNAME}:

	\typeset d=${PWD:-?} p=~; [[ $p = ?(*/) ]] || d=${d/#$p/~}
	\typeset m=${%d} n p=...; (( m > 0 )) || m=${#d}
	(( m > (n = (COLUMNS/3 < 7 ? 7 : COLUMNS/3)) )) && d=${d:(-n)} || p=
	REPLY+=$p$d

	\echo -ne "\033]0;$REPLY\007"

	(( e )) && REPLY="$e|$REPLY"
} '
